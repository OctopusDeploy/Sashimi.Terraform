FROM centos:7

VOLUME /artifacts
ENV DOTNET_CLI_TELEMETRY_OPTOUT=1

#RUN curl -o /tmp/packages-microsoft-prod.rpm https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm
#RUN rpm --import /tmp/packages-microsoft-prod.rpm
RUN rpm -Uvh https://packages.microsoft.com/config/centos/7/packages-microsoft-prod.rpm
RUN yum history sync
RUN yum -y update
RUN yum -y --nogpgcheck install dotnet-sdk-3.1
RUN yum -y clean all

WORKDIR /artifacts

ENTRYPOINT dotnet vstest Sashimi.Terraform.Tests.dll --TestCaseFilter "TestCategory != Windows" --logger trx