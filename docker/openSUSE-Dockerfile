FROM opensuse/leap:15.1

VOLUME /artifacts
ENV DOTNET_CLI_TELEMETRY_OPTOUT=1

RUN zypper -n install libicu curl && \
    curl -o /tmp/microsoft.asc https://packages.microsoft.com/keys/microsoft.asc && \
    rpm --import /tmp/microsoft.asc && \
    curl -o prod.repo https://packages.microsoft.com/config/opensuse/15/prod.repo && \
    mv prod.repo /etc/zypp/repos.d/microsoft-prod.repo && \
    chown root:root /etc/zypp/repos.d/microsoft-prod.repo && \
    zypper -n install dotnet-sdk-3.1

WORKDIR /artifacts

ENTRYPOINT dotnet vstest Sashimi.Terraform.Tests.dll --TestCaseFilter "TestCategory != Windows" --logger trx