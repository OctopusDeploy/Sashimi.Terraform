FROM registry.suse.com/suse/sle15

VOLUME /artifacts
ENV DOTNET_CLI_TELEMETRY_OPTOUT=1

RUN zypper -n update
#`RUN zypper -n install curl && \
#`    curl -o /tmp/packages-microsoft-prod.rpm https://packages.microsoft.com/config/sles/15/packages-microsoft-prod.rpm && \
#    rpm --import /tmp/packages-microsoft-prod.rpm && \
RUN wget https://packages.microsoft.com/config/sles/15/packages-microsoft-prod.rpm && \
    rpm -Uvh packages-microsoft-prod.rpm && \
    #ln -s /etc/yum.repos.d/microsoft-prod.repo /etc/zypp/repos.d/microsoft-prod.repo && \
    zypper -n install dotnet-sdk-3.1

WORKDIR /artifacts

ENTRYPOINT dotnet vstest Sashimi.Terraform.Tests.dll --TestCaseFilter "TestCategory != Windows" --logger trx