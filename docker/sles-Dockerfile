FROM registry.suse.com/suse/sle15

VOLUME /artifacts
ENV DOTNET_CLI_TELEMETRY_OPTOUT=1

RUN zypper addrepo --check --refresh -p 70 --name "packages-microsoft-com-prod" https://packages.microsoft.com/sles/15/prod "packages-microsoft-com-prod" && \
    zypper addrepo --check --refresh -p 71 --name "opensuse" http://download.opensuse.org/update/leap/15.1/oss/ "opensuse" && \
    zypper -n --no-gpg-checks install libicu dotnet-sdk-3.1

WORKDIR /artifacts

ENTRYPOINT dotnet vstest Sashimi.Terraform.Tests.dll --TestCaseFilter:"TestCategory != Windows" --logger:trx